import{ay as g,u as L,r as A,ae as D,o as E,e as b,a as _}from"./_plugin-vue_export-helper-d298c33c.js";import{V as o,s as y}from"./index-59195d65.js";/* empty css              *//* empty css              */import"./index-01d1d77d.js";/* empty css              *//* empty css              */import{A as w}from"./index-b1f79aec.js";/* empty css              */import{s as k}from"./SimpleHeader-677300a3.js";import{g as R,c as $,E as T,D as j}from"./address-150fbf9a.js";import"./index-7f09f902.js";import"./use-id-7060907e.js";import"./index-c02be924.js";import"./index-333eb155.js";import"./index-9d8ede81.js";import"./index-d0844591.js";const B={class:"address-edit-box"},ee={__name:"AddressEdit",setup(C){const l=g(),m=L(),e=A({areaList:{province_list:{},city_list:{},county_list:{}},searchResult:[],type:"add",addressId:"",addressInfo:{},from:l.query.from});D(async()=>{let t={},a={},d={};o.getLev1().forEach(s=>{t[s.id]=s.text,o.getLev2(s.id).forEach(r=>{a[r.id]=r.text,o.getLev3(r.id).forEach(i=>d[i.id]=i.text)})}),e.areaList.province_list=t,e.areaList.city_list=a,e.areaList.county_list=d;const{addressId:u,type:p,from:h}=l.query;if(e.addressId=u,e.type=p,e.from=h||"",p=="edit"){const{data:s}=await R(u);let r="";const i=o.getLev1();Object.entries(e.areaList.county_list).forEach(([c,x])=>{if(x==s.regionName){const I=i.findIndex(n=>n.id.substr(0,2)==c.substr(0,2)),N=Object.entries(e.areaList.city_list).filter(([n,F])=>n.substr(0,4)==c.substr(0,4))[0];i[I].text==s.provinceName&&N[1]==s.cityName&&(r=c)}}),e.addressInfo={id:s.addressId,name:s.userName,tel:s.userPhone,province:s.provinceName,city:s.cityName,county:s.regionName,addressDetail:s.detailAddress,areaCode:r,isDefault:!!s.defaultFlag}}});const f=async t=>{const a={userName:t.name,userPhone:t.tel,provinceName:t.province,cityName:t.city,regionName:t.county,detailAddress:t.addressDetail,defaultFlag:t.isDefault?1:0};e.type=="edit"&&(a.addressId=e.addressId),await e.type=="add"?$(a):T(a),y("保存成功"),setTimeout(()=>{m.back()},1e3)},v=async()=>{await j(e.addressId),y("删除成功"),setTimeout(()=>{m.back()},1e3)};return(t,a)=>{const d=w;return E(),b("div",B,[_(k,{name:`${e.type=="add"?"新增地址":"编辑地址"}`},null,8,["name"]),_(d,{class:"edit","area-list":e.areaList,"address-info":e.addressInfo,"show-delete":e.type=="edit","show-set-default":"","show-search-result":"","search-result":e.searchResult,"area-columns-placeholder":["请选择","请选择","请选择"],onSave:f,onDelete:v},null,8,["area-list","address-info","show-delete","search-result"])])}}};export{ee as default};
