import{G as v,r as w,ae as k,o as f,e as g,ax as m,a,av as d,aC as y}from"./_plugin-vue_export-helper-d298c33c.js";import{t as C,x,y as S}from"./index-46517163.js";import"./index-01d1d77d.js";/* empty css              *//* empty css              *//* empty css              */import{s as U}from"./SimpleHeader-677300a3.js";import{l as $,r as B}from"./user-98a6944a.js";import{m as L}from"./md5-55585f71.js";import{F as N}from"./index-1cf8f74a.js";import{B as P}from"./index-6afe3106.js";import{F as T}from"./index-dabc8ae0.js";import"./_commonjsHelpers-725317a4.js";import"./index-d82eaae7.js";import"./use-id-7060907e.js";const F=""+new URL("blockchain-334f3e74.jpg",import.meta.url).href;const I={class:"img-verify"},M=["width","height"],h={__name:"VueImageVerify",setup(b,{expose:u}){const o=v(null),r=w({pool:"ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",width:120,height:40,imgCode:""});u({state:r}),k(()=>{r.imgCode=i()});const p=()=>{r.imgCode=i()},s=(e,n)=>parseInt(Math.random()*(n-e)+e),l=(e,n)=>{const t=s(e,n),c=s(e,n),_=s(e,n);return`rgb(${t},${c},${_})`},i=()=>{const e=o.value.getContext("2d");e.fillStyle=l(180,230),e.fillRect(0,0,r.width,r.height);let n="";for(let t=0;t<4;t++){const c=r.pool[s(0,r.pool.length)];n+=c;const _=s(18,40),V=s(-30,30);e.font=_+"px Simhei",e.textBaseline="top",e.fillStyle=l(80,150),e.save(),e.translate(30*t+15,15),e.rotate(V*Math.PI/180),e.fillText(c,-15+5,-15),e.restore()}for(let t=0;t<5;t++)e.beginPath(),e.moveTo(s(0,r.width),s(0,r.height)),e.lineTo(s(0,r.width),s(0,r.height)),e.strokeStyle=l(180,230),e.closePath(),e.stroke();for(let t=0;t<40;t++)e.beginPath(),e.arc(s(0,r.width),s(0,r.height),1,0,2*Math.PI),e.closePath(),e.fillStyle=l(150,200),e.fill();return n};return(e,n)=>(f(),g("div",I,[m("canvas",{ref_key:"verify",ref:o,width:r.width,height:r.height,onClick:p},null,8,M)]))}};const R={class:"login"},q=m("img",{class:"logo",src:F,alt:""},null,-1),D={key:0,class:"login-body login"},E={style:{margin:"16px"}},G={key:1,class:"login-body register"},H={style:{margin:"16px"}},se={__name:"Login",setup(b){const u=v(null),o=w({username:"",password:"",username1:"",password1:"",type:"login",imgCode:"",verify:""}),r=s=>{o.type=s,o.verify=""},p=async s=>{if(o.imgCode=u.value.state.imgCode||"",o.verify.toLowerCase()!=o.imgCode.toLowerCase()){C("验证码有误");return}if(o.type=="login"){const{data:l}=await $({loginName:s.username,passwordMd5:L(s.password)});x("token",l),window.location.href="/"}else await B({loginName:s.username1,password:s.password1}),S("注册成功"),o.type="login",o.verify=""};return(s,l)=>{const i=N,e=P,n=T;return f(),g("div",R,[a(U,{name:o.type=="login"?"区块链商城登录":"区块链商城注册",back:"/home"},null,8,["name"]),q,o.type=="login"?(f(),g("div",D,[a(n,{onSubmit:p},{default:d(()=>[a(i,{modelValue:o.username,"onUpdate:modelValue":l[0]||(l[0]=t=>o.username=t),name:"username",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),a(i,{modelValue:o.password,"onUpdate:modelValue":l[1]||(l[1]=t=>o.password=t),type:"password",name:"password",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"]),a(i,{center:"",clearable:"",label:"验证码",placeholder:"输入验证码",modelValue:o.verify,"onUpdate:modelValue":l[2]||(l[2]=t=>o.verify=t)},{button:d(()=>[a(h,{ref_key:"verifyRef",ref:u},null,512)]),_:1},8,["modelValue"]),m("div",E,[m("div",{class:"link-register",onClick:l[3]||(l[3]=t=>r("register"))},"立即注册"),a(e,{round:"",block:"",color:"#1baeae","native-type":"submit"},{default:d(()=>[y("登录")]),_:1})])]),_:1})])):(f(),g("div",G,[a(n,{onSubmit:p},{default:d(()=>[a(i,{modelValue:o.username1,"onUpdate:modelValue":l[4]||(l[4]=t=>o.username1=t),name:"username1",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),a(i,{modelValue:o.password1,"onUpdate:modelValue":l[5]||(l[5]=t=>o.password1=t),type:"password",name:"password1",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"]),a(i,{center:"",clearable:"",label:"验证码",placeholder:"输入验证码",modelValue:o.verify,"onUpdate:modelValue":l[6]||(l[6]=t=>o.verify=t)},{button:d(()=>[a(h,{ref_key:"verifyRef",ref:u},null,512)]),_:1},8,["modelValue"]),m("div",H,[m("div",{class:"link-login",onClick:l[7]||(l[7]=t=>r("login"))},"已有登录账号"),a(e,{round:"",block:"",color:"#1baeae","native-type":"submit"},{default:d(()=>[y("注册")]),_:1})])]),_:1})]))])}}};export{se as default};
